{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\WOW\\\\Documents\\\\GitHub\\\\react\\\\react-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"C:\\\\Users\\\\WOW\\\\Documents\\\\GitHub\\\\react\\\\react-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _toConsumableArray from\"C:\\\\Users\\\\WOW\\\\Documents\\\\GitHub\\\\react\\\\react-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:\\\\Users\\\\WOW\\\\Documents\\\\GitHub\\\\react\\\\react-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import{profileAPI}from'../API/api';import{stopSubmit}from'redux-form';import{usersAPI}from'../API/api';var SEND_POST='profile-reducer/SEND_POST';var SET_USER_PROFILE='profile-reducer/SET_USER_PROFILE';var SET_USER_STATUS='profile-reducer/SET_USER_STATUS';var SET_PHOTO_PROFILE='profile-reducer/SET_PHOTO_PROFILE';var SET_EDIT_PROFILE='profile-reducer/SET_EDIT_PROFILE';var RESET_USER_POFILE='profile-reducer/RESET_USER_POFILE';var FOLLOW_UNFOLLOW_SUCCESS='profile-reducer/FOLLOW_UNFOLLOW_SUCCESS';var TOGGLE_IS_FETCHING='profile-reducer/TOGGLE_IS_FETCHING';var SEND_MESSAGE_MODE='profile-reducer/SEND_MESSAGE_MODE';var SET_POPPUP_AVATAR='profile-reducer/SET_POPPUP_AVATAR';var TOGGLE_LIKE_SUCCESS='profile-reducer/TOGGLE_LIKE_SUCCESS';var DELETE_POST_SUCCESS='profile-reducer/DELETE_POST_SUCCESS';var SORT_BY_TIME='profile-reducer/SORT_BY_TIME';var SORT_BY_LIKES='profile-reducer/SORT_BY_LIKES';var IS_USER_EXIST='profile-reducer/IS_USER_EXIST';var options={year:'numeric',month:'long',day:'numeric',timezone:'UTC',hour:'numeric',minute:'numeric'};var initialState={posts:[{name:'ChelCode',userId:'1601',avatar:'https://social-network.samuraijs.com/activecontent/images/users/1601/user-small.jpg?v=13',text:'Whats up??!',id:2,likesCount:0,time:1574713363365,timeFormat:'November 11, 2019, 10:20 PM',liked:false},{name:'ChelCode',avatar:'https://social-network.samuraijs.com/activecontent/images/users/1601/user-small.jpg?v=13',text:'hello world!!',userId:'1601',id:1,likesCount:12,time:1574713324589,timeFormat:'November 9, 2019, 2:46 PM',liked:false}],currentTextPost:'',profile:null,status:'',isEditMode:false,isFollowed:false,isFetching:false,sendMessageMode:false,avatarPopup:false,isUserExist:true};var profileReducer=function profileReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SEND_POST:return _objectSpread({},state,{posts:[{text:action.post.postBody,time:action.time,id:state.posts.length+1,likesCount:0,timeFormat:action.timeFormat,liked:false,name:action.name,avatar:action.avatar,userId:action.userId}].concat(_toConsumableArray(state.posts))});case SET_USER_PROFILE:return _objectSpread({},state,{profile:action.profile});case SET_USER_STATUS:return _objectSpread({},state,{status:action.status});case SET_PHOTO_PROFILE:return _objectSpread({},state,{profile:_objectSpread({},state.profile,{photos:action.photos})});case SET_EDIT_PROFILE:return _objectSpread({},state,{isEditMode:action.mode});case RESET_USER_POFILE:return initialState;case FOLLOW_UNFOLLOW_SUCCESS:return _objectSpread({},state,{isFollowed:action.isFollow});case TOGGLE_IS_FETCHING:return _objectSpread({},state,{isFetching:action.isFetching});case SEND_MESSAGE_MODE:return _objectSpread({},state,{sendMessageMode:action.isSendMode});case SET_POPPUP_AVATAR:return _objectSpread({},state,{avatarPopup:action.isPopup});case TOGGLE_LIKE_SUCCESS:return _objectSpread({},state,{posts:state.posts.map(function(p){return action.idPost===p.id?_objectSpread({},p,{liked:action.isLiked,likesCount:action.isLiked?p.likesCount+1:p.likesCount-1}):p;})});case DELETE_POST_SUCCESS:return _objectSpread({},state,{posts:state.posts.filter(function(p){return p.id!==action.idPost;}).map(function(p,index){return _objectSpread({},p,{id:index+1});})});case SORT_BY_TIME:return _objectSpread({},state,{posts:_toConsumableArray(state.posts.sort(function(a,b){return b.time-a.time;}))});case SORT_BY_LIKES:return _objectSpread({},state,{posts:_toConsumableArray(state.posts.sort(function(a,b){return b.likesCount-a.likesCount;}))});case IS_USER_EXIST:return _objectSpread({},state,{},action.payload);default:return state;}};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var resetProfile=function resetProfile(){return{type:RESET_USER_POFILE};};export var sendPost=function sendPost(post,name,avatar,userId){return{type:SEND_POST,post:post,timeFormat:new Date().toLocaleString(\"en-US\",options),time:Date.now(),name:name,avatar:avatar,userId:userId};};export var setEditProfile=function setEditProfile(mode){return{type:SET_EDIT_PROFILE,mode:mode};};export var setUserProfile=function setUserProfile(profile){return{type:SET_USER_PROFILE,profile:profile};};export var setUserStatus=function setUserStatus(status){return{type:SET_USER_STATUS,status:status};};export var setFollowUnfollow=function setFollowUnfollow(isFollow){return{type:FOLLOW_UNFOLLOW_SUCCESS,isFollow:isFollow};};export var setMessageMode=function setMessageMode(isSendMode){return{type:SEND_MESSAGE_MODE,isSendMode:isSendMode};};export var setPopupAvatar=function setPopupAvatar(isPopup){return{type:SET_POPPUP_AVATAR,isPopup:isPopup};};export var likesToggle=function likesToggle(isLiked,idPost){return{type:TOGGLE_LIKE_SUCCESS,isLiked:isLiked,idPost:idPost};};export var deletePost=function deletePost(idPost){return{type:DELETE_POST_SUCCESS,idPost:idPost};};export var sortByTime=function sortByTime(){return{type:SORT_BY_TIME};};export var sortByLikes=function sortByLikes(){return{type:SORT_BY_LIKES};};export var setIsUserExist=function setIsUserExist(isUserExist){return{type:IS_USER_EXIST,payload:{isUserExist:isUserExist}};};export var sendPostThunk=function sendPostThunk(post){return function(dispatch,getState){var name=getState().auth.login;var avatar=getState().auth.avatar;var userId=getState().auth.id;dispatch(sendPost(post,name,avatar,userId));};};export var getProfileThunk=function getProfileThunk(userId){return function _callee(dispatch){var response;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(profileAPI.getProfile(userId).catch(function(){dispatch(setIsUserExist(false));}));case 2:response=_context.sent;if(response){dispatch(setUserProfile(response.data));}case 4:case\"end\":return _context.stop();}}});};};var savePhotoSucсess=function savePhotoSucсess(photos){return{type:SET_PHOTO_PROFILE,photos:photos};};export var getStatusThunk=function getStatusThunk(userId){return function _callee2(dispatch){var data;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regeneratorRuntime.awrap(profileAPI.getUserStatus(userId));case 2:data=_context2.sent;dispatch(setUserStatus(data));case 4:case\"end\":return _context2.stop();}}});};};export var updateStatusThunk=function updateStatusThunk(status){return function _callee3(dispatch){var data;return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _regeneratorRuntime.awrap(profileAPI.updateUserStatus(status));case 2:data=_context3.sent;if(data.resultCode===0){dispatch(setUserStatus(status));}case 4:case\"end\":return _context3.stop();}}});};};export var savePhotoThunk=function savePhotoThunk(photo){return function _callee4(dispatch){var data;return _regeneratorRuntime.async(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _regeneratorRuntime.awrap(profileAPI.updatePhoto(photo));case 2:data=_context4.sent;if(data.resultCode===0){dispatch(savePhotoSucсess(data.data.photos));}case 4:case\"end\":return _context4.stop();}}});};};export var saveProfileData=function saveProfileData(profile){return function _callee5(dispatch,getState){var userId,response,number,test;return _regeneratorRuntime.async(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:userId=getState().auth.id;_context5.next=3;return _regeneratorRuntime.awrap(profileAPI.saveProfileData(profile));case 3:response=_context5.sent;if(response.resultCode===0){dispatch(getProfileThunk(userId));dispatch(setEditProfile(false));}else{number=response.messages[0].indexOf('>');test=response.messages[0].slice(number+1,-1).toLowerCase();dispatch(stopSubmit('edit-profile',{'contacts':_defineProperty({},test,test+' incorrect')}));}case 5:case\"end\":return _context5.stop();}}});};};export var getFollowedThunk=function getFollowedThunk(id){return function _callee6(dispatch){var data;return _regeneratorRuntime.async(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return _regeneratorRuntime.awrap(usersAPI.getFollow(id));case 2:data=_context6.sent;dispatch(setFollowUnfollow(data));case 4:case\"end\":return _context6.stop();}}});};};export var followUnfollow=function followUnfollow(isFollow,id){return function _callee7(dispatch){var data;return _regeneratorRuntime.async(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:dispatch(toggleIsFetching(true));if(!isFollow){_context7.next=7;break;}_context7.next=4;return _regeneratorRuntime.awrap(usersAPI.postFollow(id));case 4:_context7.t0=_context7.sent;_context7.next=10;break;case 7:_context7.next=9;return _regeneratorRuntime.awrap(usersAPI.deleteFollow(id));case 9:_context7.t0=_context7.sent;case 10:data=_context7.t0;if(data.resultCode===0){dispatch(setFollowUnfollow(isFollow));dispatch(toggleIsFetching(false));}case 12:case\"end\":return _context7.stop();}}});};};export default profileReducer;","map":{"version":3,"sources":["C:/Users/WOW/Documents/GitHub/react/react-test/src/redux/profile-reducer.js"],"names":["profileAPI","stopSubmit","usersAPI","SEND_POST","SET_USER_PROFILE","SET_USER_STATUS","SET_PHOTO_PROFILE","SET_EDIT_PROFILE","RESET_USER_POFILE","FOLLOW_UNFOLLOW_SUCCESS","TOGGLE_IS_FETCHING","SEND_MESSAGE_MODE","SET_POPPUP_AVATAR","TOGGLE_LIKE_SUCCESS","DELETE_POST_SUCCESS","SORT_BY_TIME","SORT_BY_LIKES","IS_USER_EXIST","options","year","month","day","timezone","hour","minute","initialState","posts","name","userId","avatar","text","id","likesCount","time","timeFormat","liked","currentTextPost","profile","status","isEditMode","isFollowed","isFetching","sendMessageMode","avatarPopup","isUserExist","profileReducer","state","action","type","post","postBody","length","photos","mode","isFollow","isSendMode","isPopup","map","p","idPost","isLiked","filter","index","sort","a","b","payload","toggleIsFetching","resetProfile","sendPost","Date","toLocaleString","now","setEditProfile","setUserProfile","setUserStatus","setFollowUnfollow","setMessageMode","setPopupAvatar","likesToggle","deletePost","sortByTime","sortByLikes","setIsUserExist","sendPostThunk","dispatch","getState","auth","login","getProfileThunk","getProfile","catch","response","data","savePhotoSucсess","getStatusThunk","getUserStatus","updateStatusThunk","updateUserStatus","resultCode","savePhotoThunk","photo","updatePhoto","saveProfileData","number","messages","indexOf","test","slice","toLowerCase","getFollowedThunk","getFollow","followUnfollow","postFollow","deleteFollow"],"mappings":"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","sourcesContent":["import { profileAPI } from '../API/api'\r\nimport { stopSubmit } from 'redux-form'\r\nimport { usersAPI } from '../API/api'\r\n\r\n\r\n\r\nconst SEND_POST = 'profile-reducer/SEND_POST'\r\nconst SET_USER_PROFILE = 'profile-reducer/SET_USER_PROFILE'\r\nconst SET_USER_STATUS = 'profile-reducer/SET_USER_STATUS'\r\nconst SET_PHOTO_PROFILE = 'profile-reducer/SET_PHOTO_PROFILE'\r\nconst SET_EDIT_PROFILE = 'profile-reducer/SET_EDIT_PROFILE'\r\nconst RESET_USER_POFILE = 'profile-reducer/RESET_USER_POFILE'\r\nconst FOLLOW_UNFOLLOW_SUCCESS = 'profile-reducer/FOLLOW_UNFOLLOW_SUCCESS'\r\nconst TOGGLE_IS_FETCHING = 'profile-reducer/TOGGLE_IS_FETCHING'\r\nconst SEND_MESSAGE_MODE = 'profile-reducer/SEND_MESSAGE_MODE'\r\nconst SET_POPPUP_AVATAR = 'profile-reducer/SET_POPPUP_AVATAR'\r\nconst TOGGLE_LIKE_SUCCESS = 'profile-reducer/TOGGLE_LIKE_SUCCESS'\r\nconst DELETE_POST_SUCCESS = 'profile-reducer/DELETE_POST_SUCCESS'\r\nconst SORT_BY_TIME = 'profile-reducer/SORT_BY_TIME'\r\nconst SORT_BY_LIKES = 'profile-reducer/SORT_BY_LIKES'\r\nconst IS_USER_EXIST = 'profile-reducer/IS_USER_EXIST'\r\n\r\nconst options = {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n    timezone: 'UTC',\r\n    hour: 'numeric',\r\n    minute: 'numeric'\r\n}\r\n\r\n\r\nconst initialState = {\r\n    posts: [\r\n        {\r\n            name: 'ChelCode', userId: '1601', avatar: 'https://social-network.samuraijs.com/activecontent/images/users/1601/user-small.jpg?v=13',\r\n            text: 'Whats up??!', id: 2, likesCount: 0, time: 1574713363365, timeFormat: 'November 11, 2019, 10:20 PM', liked: false\r\n        },\r\n        {\r\n            name: 'ChelCode', avatar: 'https://social-network.samuraijs.com/activecontent/images/users/1601/user-small.jpg?v=13',\r\n            text: 'hello world!!', userId: '1601', id: 1, likesCount: 12, time: 1574713324589, timeFormat: 'November 9, 2019, 2:46 PM', liked: false\r\n        }],\r\n    currentTextPost: '',\r\n    profile: null,\r\n    status: '',\r\n    isEditMode: false,\r\n    isFollowed: false,\r\n    isFetching: false,\r\n    sendMessageMode: false,\r\n    avatarPopup: false,\r\n    isUserExist: true\r\n}\r\n\r\nconst profileReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n\r\n        case SEND_POST:\r\n            return {\r\n                ...state,\r\n                posts: [{\r\n                    text: action.post.postBody, time: action.time, id: state.posts.length + 1, likesCount: 0, timeFormat: action.timeFormat, liked: false,\r\n                    name: action.name, avatar: action.avatar, userId: action.userId\r\n                }, ...state.posts],\r\n            }\r\n        case SET_USER_PROFILE:\r\n            return { ...state, profile: action.profile }\r\n        case SET_USER_STATUS:\r\n            return { ...state, status: action.status }\r\n        case SET_PHOTO_PROFILE:\r\n            return { ...state, profile: { ...state.profile, photos: action.photos } }\r\n        case SET_EDIT_PROFILE:\r\n            return { ...state, isEditMode: action.mode }\r\n        case RESET_USER_POFILE:\r\n            return initialState\r\n        case FOLLOW_UNFOLLOW_SUCCESS:\r\n            return { ...state, isFollowed: action.isFollow }\r\n        case TOGGLE_IS_FETCHING:\r\n            return { ...state, isFetching: action.isFetching }\r\n        case SEND_MESSAGE_MODE:\r\n            return { ...state, sendMessageMode: action.isSendMode }\r\n        case SET_POPPUP_AVATAR:\r\n            return { ...state, avatarPopup: action.isPopup }\r\n        case TOGGLE_LIKE_SUCCESS:\r\n            return { ...state, posts: state.posts.map(p => action.idPost === p.id ? { ...p, liked: action.isLiked, likesCount: action.isLiked ? p.likesCount + 1 : p.likesCount - 1 } : p) }\r\n        case DELETE_POST_SUCCESS:\r\n            return { ...state, posts: state.posts.filter(p => p.id !== action.idPost).map((p, index) => { return { ...p, id: index + 1 } }) }\r\n        case SORT_BY_TIME:\r\n            return { ...state, posts: [...state.posts.sort((a, b) => { return b.time - a.time })] }\r\n        case SORT_BY_LIKES:\r\n            return { ...state, posts: [...state.posts.sort((a, b) => { return b.likesCount - a.likesCount })] }\r\n        case IS_USER_EXIST:\r\n            return {...state, ...action.payload}    \r\n        default: return state\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n\r\nexport const toggleIsFetching = (isFetching) => ({ type: TOGGLE_IS_FETCHING, isFetching })\r\nexport const resetProfile = () => ({ type: RESET_USER_POFILE })\r\nexport const sendPost = (post, name, avatar, userId) => ({ type: SEND_POST, post, timeFormat: new Date().toLocaleString(\"en-US\", options), time: Date.now(), name, avatar, userId })\r\n\r\n\r\nexport const setEditProfile = (mode) => ({ type: SET_EDIT_PROFILE, mode })\r\nexport const setUserProfile = (profile) => ({ type: SET_USER_PROFILE, profile })\r\nexport const setUserStatus = (status) => ({ type: SET_USER_STATUS, status })\r\nexport const setFollowUnfollow = (isFollow) => ({ type: FOLLOW_UNFOLLOW_SUCCESS, isFollow })\r\nexport const setMessageMode = (isSendMode) => ({ type: SEND_MESSAGE_MODE, isSendMode })\r\nexport const setPopupAvatar = (isPopup) => ({ type: SET_POPPUP_AVATAR, isPopup })\r\nexport const likesToggle = (isLiked, idPost) => ({ type: TOGGLE_LIKE_SUCCESS, isLiked, idPost })\r\nexport const deletePost = (idPost) => ({ type: DELETE_POST_SUCCESS, idPost })\r\nexport const sortByTime = () => ({ type: SORT_BY_TIME })\r\nexport const sortByLikes = () => ({ type: SORT_BY_LIKES })\r\nexport const setIsUserExist = (isUserExist) => ({ type: IS_USER_EXIST, payload: {isUserExist} })\r\n\r\nexport const sendPostThunk = (post) => (dispatch, getState) => {\r\n\r\n    const name = getState().auth.login\r\n    const avatar = getState().auth.avatar\r\n    const userId = getState().auth.id\r\n    dispatch(sendPost(post, name, avatar, userId))\r\n}\r\nexport const getProfileThunk = (userId) => async (dispatch) => {\r\n    \r\n    \r\n    const response = await (profileAPI.getProfile(userId)).catch(()=>{\r\n        dispatch(setIsUserExist(false))\r\n    })\r\n    \r\n      if(response){\r\n          \r\n        dispatch(setUserProfile(response.data))  \r\n    } \r\n\r\n      \r\n    \r\n     \r\n}\r\n\r\nconst savePhotoSucсess = (photos) => ({ type: SET_PHOTO_PROFILE, photos })\r\n\r\nexport const getStatusThunk = (userId) => async (dispatch) => {\r\n    const data = await (profileAPI.getUserStatus(userId))\r\n\r\n    dispatch(setUserStatus(data))\r\n\r\n}\r\nexport const updateStatusThunk = (status) => async (dispatch) => {\r\n    const data = await (profileAPI.updateUserStatus(status))\r\n\r\n    if (data.resultCode === 0) {\r\n        dispatch(setUserStatus(status))\r\n    }\r\n\r\n}\r\nexport const savePhotoThunk = (photo) => async (dispatch) => {\r\n    const data = await (profileAPI.updatePhoto(photo))\r\n\r\n    if (data.resultCode === 0) {\r\n        dispatch(savePhotoSucсess(data.data.photos))\r\n    }\r\n\r\n}\r\nexport const saveProfileData = (profile) => async (dispatch, getState) => {\r\n    const userId = getState().auth.id\r\n    const response = await (profileAPI.saveProfileData(profile))\r\n\r\n\r\n    if (response.resultCode === 0) {\r\n        dispatch(getProfileThunk(userId))\r\n        dispatch(setEditProfile(false))\r\n    } else {\r\n        let number = response.messages[0].indexOf('>')\r\n        let test = response.messages[0].slice(number + 1, -1).toLowerCase()\r\n        dispatch(stopSubmit('edit-profile', { 'contacts': { [test]: test + ' incorrect' } }))\r\n    }\r\n}\r\nexport const getFollowedThunk = (id) => async (dispatch) => {\r\n    const data = await (usersAPI.getFollow(id))\r\n    dispatch(setFollowUnfollow(data))\r\n\r\n}\r\nexport const followUnfollow = (isFollow, id) => async (dispatch) => {\r\n    dispatch(toggleIsFetching(true))\r\n    const data =\r\n        isFollow\r\n            ? await usersAPI.postFollow(id)\r\n            : await usersAPI.deleteFollow(id)\r\n    if (data.resultCode === 0) {\r\n        dispatch(setFollowUnfollow(isFollow))\r\n        dispatch(toggleIsFetching(false))\r\n    }\r\n\r\n\r\n}\r\nexport default profileReducer"]},"metadata":{},"sourceType":"module"}