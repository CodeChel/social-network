{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\WOW\\\\Documents\\\\GitHub\\\\react\\\\react-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:\\\\Users\\\\WOW\\\\Documents\\\\GitHub\\\\react\\\\react-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"C:\\\\Users\\\\WOW\\\\Documents\\\\GitHub\\\\react\\\\react-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";import React,{useState,useRef,useEffect}from'react';import styles from'./Messages.module.css';import DialogWithUser from'./DialogsList/DialogWithUser';import DialogSession from'./DialogSession';import ScrollbarHOC from'../../common/HOCScrollBar/HOCScrollbarCusctom';import{Switch}from'react-router';import{Route}from'react-router-dom';import EmptyDialogMessages from'./EmpyDialogSession';var Messages=function Messages(_ref){var dialogItemsData=_ref.dialogItemsData,setSearch=_ref.setSearch,dialogsFromSearch=_ref.dialogsFromSearch,props=_objectWithoutProperties(_ref,[\"dialogItemsData\",\"setSearch\",\"dialogsFromSearch\"]);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),searchWord=_useState2[0],setSearchWord=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isSearchMode=_useState4[0],setSearchMode=_useState4[1];var breakpoint=790;useEffect(function(){var outSearhCheck=function outSearhCheck(e){if(e.target!==searchInput.current&&e.target!==dialogRef.current){outSearch();}};if(isSearchMode){document.addEventListener('click',outSearhCheck);}else{document.removeEventListener('click',outSearhCheck);}return function(){document.removeEventListener('click',outSearhCheck);};},[isSearchMode]);var searchInput=useRef();var dialogRef=useRef();var handleSearch=function handleSearch(e){var word=e.currentTarget.value;setSearchWord(word);if(word&&word.trim()!==''){setSearch(word);setSearchMode(true);}};var outSearch=function outSearch(){setSearchMode(false);setSearchWord('');};var currentDialogId=+props.match.params.userId?+props.match.params.userId:0;var currentDialog=currentDialogId&&dialogItemsData[dialogItemsData.findIndex(function(i){return i.userId===currentDialogId;})];var dialogItems=dialogItemsData.map(function(item,index){return React.createElement(DialogWithUser,{avatar:item.avatar,currentDialogId:currentDialogId,date:item.messages[item.messages.length-1].date,isYoursMessage:item.messages[item.messages.length-1].right,lastMessage:item.messages[item.messages.length-1].message,key:index+1,name:item.name,id:item.userId});});var dialogItemsSearch=isSearchMode&&dialogsFromSearch.map(function(item,index){return React.createElement(DialogWithUser,{dialogRef:dialogRef,isSearchMode:isSearchMode,avatar:item.avatar,outSearch:outSearch,lastMessage:item.messages[item.messages.length-1].message,date:item.messages[item.messages.length-1].date,isYoursMessage:item.messages[item.messages.length-1].right,key:index+1,name:item.name,id:item.userId,currentDialogId:currentDialogId});});return ResponsiveLayout(breakpoint,renderDesktop,renderMobile,_objectSpread({currentDialogId:currentDialogId,currentDialog:currentDialog,dialogItemsSearch:dialogItemsSearch,dialogItems:dialogItems,handleSearch:handleSearch,isSearchMode:isSearchMode,searchInput:searchInput,searchWord:searchWord},props));};var ResponsiveLayout=function ResponsiveLayout(breakpoint,renderDesktop,renderMobile,props){var _useState5=useState(window.innerWidth),_useState6=_slicedToArray(_useState5,2),width=_useState6[0],setWidth=_useState6[1];useEffect(function(){var handleResize=function handleResize(){setWidth(window.innerWidth);};window.addEventListener('resize',handleResize);return function(){window.removeEventListener('resize',handleResize);};},[]);return width>breakpoint?renderDesktop(props):renderMobile(props);};var renderDesktop=function renderDesktop(props){return React.createElement(MessagesDesktop,props);};var renderMobile=function renderMobile(props){return React.createElement(MessagesMobile,props);};var MessagesMobile=function MessagesMobile(_ref2){var currentDialogId=_ref2.currentDialogId,isSearchMode=_ref2.isSearchMode,currentDialog=_ref2.currentDialog,searchInput=_ref2.searchInput,searchWord=_ref2.searchWord,dialogItemsSearch=_ref2.dialogItemsSearch,dialogItems=_ref2.dialogItems,handleSearch=_ref2.handleSearch,props=_objectWithoutProperties(_ref2,[\"currentDialogId\",\"isSearchMode\",\"currentDialog\",\"searchInput\",\"searchWord\",\"dialogItemsSearch\",\"dialogItems\",\"handleSearch\"]);return React.createElement(\"div\",{className:styles.messagesMobile},!!currentDialogId&&React.createElement(Switch,null,React.createElement(Route,{exact:true,path:\"/messages/\",render:function render(){return React.createElement(EmptyDialogMessages,null);}}),React.createElement(Route,{path:\"/:userId\",render:function render(){return React.createElement(DialogSession,{historyChatHeight:\"65%\",valueMessage:props.valueMessage,isSearchMode:isSearchMode,userId:currentDialogId,sendMessage:props.sendMessage,currentDialog:currentDialog,isFetching:props.isFetching,getUserForMessages:props.getUserForMessages,userForMessage:props.userForMessage,setNewDialog:props.setNewDialog,setUserForMessages:props.setUserForMessages});}})),!currentDialogId&&React.createElement(\"div\",{className:styles.dialogItems},React.createElement(\"div\",{className:styles.dialogSearch},React.createElement(\"input\",{ref:searchInput,placeholder:\"Search\",className:styles.searchInput,value:searchWord,onChange:function onChange(e){return handleSearch(e);},type:\"text\",name:\"\",id:\"\"})),React.createElement(\"div\",{className:styles.dialogsList},React.createElement(ScrollbarHOC,{children:isSearchMode?dialogItemsSearch:dialogItems,removeTrackYWhenNotUsed:true,style:{width:\"100%\",height:\"88vh\"}}))));};var MessagesDesktop=function MessagesDesktop(_ref3){var currentDialogId=_ref3.currentDialogId,isSearchMode=_ref3.isSearchMode,currentDialog=_ref3.currentDialog,searchInput=_ref3.searchInput,searchWord=_ref3.searchWord,dialogItemsSearch=_ref3.dialogItemsSearch,dialogItems=_ref3.dialogItems,handleSearch=_ref3.handleSearch,props=_objectWithoutProperties(_ref3,[\"currentDialogId\",\"isSearchMode\",\"currentDialog\",\"searchInput\",\"searchWord\",\"dialogItemsSearch\",\"dialogItems\",\"handleSearch\"]);return React.createElement(\"div\",{className:styles.messages},React.createElement(Switch,null,React.createElement(Route,{exact:true,path:\"/messages/\",render:function render(){return React.createElement(EmptyDialogMessages,null);}}),React.createElement(Route,{path:\"/:userId\",render:function render(){return React.createElement(DialogSession,{historyChatHeight:\"75%\",valueMessage:props.valueMessage,isSearchMode:isSearchMode,userId:currentDialogId,sendMessage:props.sendMessage,currentDialog:currentDialog,isFetching:props.isFetching,getUserForMessages:props.getUserForMessages,userForMessage:props.userForMessage,setNewDialog:props.setNewDialog,setUserForMessages:props.setUserForMessages});}})),React.createElement(\"div\",{className:styles.dialogItems},React.createElement(\"div\",{className:styles.dialogSearch},React.createElement(\"input\",{ref:searchInput,placeholder:\"Search\",className:styles.searchInput,value:searchWord,onChange:function onChange(e){return handleSearch(e);},type:\"text\",name:\"\",id:\"\"})),React.createElement(\"div\",{className:styles.dialogsList},React.createElement(ScrollbarHOC,{children:isSearchMode?dialogItemsSearch:dialogItems,removeTrackYWhenNotUsed:true,style:{width:\"100%\",height:\"85vh\"}}))));};export default Messages;","map":{"version":3,"sources":["C:/Users/WOW/Documents/GitHub/react/react-test/src/components/Messages-container/Messages/Messages.jsx"],"names":["React","useState","useRef","useEffect","styles","DialogWithUser","DialogSession","ScrollbarHOC","Switch","Route","EmptyDialogMessages","Messages","dialogItemsData","setSearch","dialogsFromSearch","props","searchWord","setSearchWord","isSearchMode","setSearchMode","breakpoint","outSearhCheck","e","target","searchInput","current","dialogRef","outSearch","document","addEventListener","removeEventListener","handleSearch","word","currentTarget","value","trim","currentDialogId","match","params","userId","currentDialog","findIndex","i","dialogItems","map","item","index","avatar","messages","length","date","right","message","name","dialogItemsSearch","ResponsiveLayout","renderDesktop","renderMobile","window","innerWidth","width","setWidth","handleResize","MessagesMobile","messagesMobile","valueMessage","sendMessage","isFetching","getUserForMessages","userForMessage","setNewDialog","setUserForMessages","dialogSearch","dialogsList","height","MessagesDesktop"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from 'react'\r\nimport styles from './Messages.module.css'\r\nimport DialogWithUser from './DialogsList/DialogWithUser'\r\nimport DialogSession from './DialogSession'\r\nimport ScrollbarHOC from '../../common/HOCScrollBar/HOCScrollbarCusctom'\r\nimport { Switch } from 'react-router'\r\nimport { Route } from 'react-router-dom'\r\nimport EmptyDialogMessages from './EmpyDialogSession'\r\n\r\n\r\n\r\n\r\n\r\nconst Messages = ({ dialogItemsData, setSearch, dialogsFromSearch, ...props }) => {\r\n\r\n    const [searchWord, setSearchWord] = useState('');\r\n    const [isSearchMode, setSearchMode] = useState(false);\r\n    const breakpoint = 790;\r\n\r\n    useEffect(() => {\r\n        const outSearhCheck = (e) => {\r\n            if (e.target !== searchInput.current && e.target !== dialogRef.current) {\r\n                outSearch()\r\n            }\r\n\r\n        }\r\n        if (isSearchMode) {\r\n            document.addEventListener('click', outSearhCheck)\r\n        }\r\n        else {\r\n            document.removeEventListener('click', outSearhCheck)\r\n        }\r\n        return () => {\r\n            document.removeEventListener('click', outSearhCheck)\r\n        }\r\n    }, [isSearchMode])\r\n\r\n    const searchInput = useRef();\r\n    const dialogRef = useRef();\r\n\r\n    const handleSearch = (e) => {\r\n        const word = e.currentTarget.value;\r\n        setSearchWord(word);\r\n        if (word && word.trim() !== '') {\r\n            setSearch(word)\r\n            setSearchMode(true)\r\n        }\r\n    }\r\n    const outSearch = () => {\r\n        setSearchMode(false)\r\n        setSearchWord('')\r\n    }\r\n\r\n    const currentDialogId = +props.match.params.userId ? +props.match.params.userId : 0;\r\n    const currentDialog = currentDialogId && dialogItemsData[dialogItemsData.findIndex((i) => { return i.userId === currentDialogId })];\r\n\r\n    const dialogItems = dialogItemsData.map((item, index) => <DialogWithUser avatar={item.avatar} currentDialogId={currentDialogId}\r\n        date={item.messages[item.messages.length - 1].date} isYoursMessage={item.messages[item.messages.length - 1].right}\r\n        lastMessage={item.messages[item.messages.length - 1].message} key={index + 1} name={item.name} id={item.userId} />)\r\n\r\n    const dialogItemsSearch = isSearchMode && dialogsFromSearch.map((item, index) => <DialogWithUser dialogRef={dialogRef} isSearchMode={isSearchMode}\r\n        avatar={item.avatar} outSearch={outSearch} lastMessage={item.messages[item.messages.length - 1].message}\r\n        date={item.messages[item.messages.length - 1].date} isYoursMessage={item.messages[item.messages.length - 1].right}\r\n        key={index + 1} name={item.name} id={item.userId} currentDialogId={currentDialogId} />)\r\n\r\n\r\n\r\n    return ResponsiveLayout(breakpoint, renderDesktop, renderMobile, { currentDialogId, currentDialog, dialogItemsSearch, dialogItems, handleSearch, isSearchMode, searchInput, searchWord, ...props })\r\n}\r\n\r\n\r\nconst ResponsiveLayout = (breakpoint, renderDesktop, renderMobile, props ) => {\r\n    const [width, setWidth] = useState(window.innerWidth)\r\n    useEffect(() => {\r\n        const handleResize = () => {\r\n            setWidth(window.innerWidth)\r\n        }\r\n        window.addEventListener('resize', handleResize)\r\n        return () => { window.removeEventListener('resize', handleResize) }\r\n    }, [])\r\n    return (width > breakpoint ? renderDesktop(props) : renderMobile(props))\r\n}\r\n\r\nconst renderDesktop = (props) => {\r\n    return <MessagesDesktop {...props} />\r\n}\r\nconst renderMobile = (props) => {\r\n    return <MessagesMobile {...props} />\r\n}\r\n\r\nconst MessagesMobile = ({ currentDialogId, isSearchMode, currentDialog, searchInput, searchWord, dialogItemsSearch, dialogItems, handleSearch, ...props }) => {\r\n\r\n    return <div className={styles.messagesMobile} >\r\n\r\n        {!!currentDialogId &&\r\n            <Switch>\r\n                <Route exact path={`/messages/`} render={() => <EmptyDialogMessages />} />\r\n                <Route path={`/:userId`} render={() => <DialogSession historyChatHeight='65%' valueMessage={props.valueMessage} isSearchMode={isSearchMode} userId={currentDialogId}\r\n                    sendMessage={props.sendMessage} currentDialog={currentDialog} isFetching={props.isFetching} getUserForMessages={props.getUserForMessages}\r\n                    userForMessage={props.userForMessage} setNewDialog={props.setNewDialog} setUserForMessages={props.setUserForMessages} />} />\r\n\r\n            </Switch>\r\n\r\n        }\r\n\r\n        {!currentDialogId && <div className={styles.dialogItems}>\r\n            <div className={styles.dialogSearch}>\r\n                <input ref={searchInput} placeholder='Search' className={styles.searchInput} value={searchWord} onChange={e => handleSearch(e)} type=\"text\" name=\"\" id=\"\" />\r\n            </div>\r\n            <div className={styles.dialogsList}>\r\n                <ScrollbarHOC children={isSearchMode ? dialogItemsSearch : dialogItems} removeTrackYWhenNotUsed={true} style={{ width: \"100%\", height: \"88vh\" }} />\r\n            </div>\r\n        </div>}\r\n\r\n    </div>\r\n\r\n}\r\nconst MessagesDesktop = ({ currentDialogId, isSearchMode, currentDialog, searchInput, searchWord, dialogItemsSearch, dialogItems, handleSearch, ...props }) => {\r\n    return <div className={styles.messages} >\r\n\r\n        <Switch>\r\n            <Route exact path={`/messages/`} render={() => <EmptyDialogMessages />} />\r\n            <Route path={`/:userId`} render={() => <DialogSession historyChatHeight='75%' valueMessage={props.valueMessage} isSearchMode={isSearchMode} userId={currentDialogId}\r\n                sendMessage={props.sendMessage} currentDialog={currentDialog} isFetching={props.isFetching} getUserForMessages={props.getUserForMessages}\r\n                userForMessage={props.userForMessage} setNewDialog={props.setNewDialog} setUserForMessages={props.setUserForMessages} />} />\r\n\r\n        </Switch>\r\n\r\n\r\n\r\n\r\n\r\n\r\n        <div className={styles.dialogItems}>\r\n            <div className={styles.dialogSearch}>\r\n                <input ref={searchInput} placeholder='Search' className={styles.searchInput} value={searchWord} onChange={e => handleSearch(e)} type=\"text\" name=\"\" id=\"\" />\r\n            </div>\r\n            <div className={styles.dialogsList}>\r\n                <ScrollbarHOC children={isSearchMode ? dialogItemsSearch : dialogItems} removeTrackYWhenNotUsed={true} style={{ width: \"100%\", height: \"85vh\" }} />\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n}\r\n\r\nexport default Messages;"]},"metadata":{},"sourceType":"module"}