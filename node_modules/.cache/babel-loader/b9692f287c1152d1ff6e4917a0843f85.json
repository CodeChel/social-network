{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\WOW\\\\Documents\\\\GitHub\\\\react\\\\react-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"C:\\\\Users\\\\WOW\\\\Documents\\\\GitHub\\\\react\\\\react-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _toConsumableArray from\"C:\\\\Users\\\\WOW\\\\Documents\\\\GitHub\\\\react\\\\react-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:\\\\Users\\\\WOW\\\\Documents\\\\GitHub\\\\react\\\\react-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import{profileAPI}from'../API/api';import{stopSubmit}from'redux-form';import{usersAPI}from'../API/api';import*as profileR from'./profile-reducer';export var SEND_POST='profile-reducer/SEND_POST';export var SET_USER_PROFILE='profile-reducer/SET_USER_PROFILE';export var SET_USER_STATUS='profile-reducer/SET_USER_STATUS';export var SET_PHOTO_PROFILE='profile-reducer/SET_PHOTO_PROFILE';export var SET_EDIT_PROFILE='profile-reducer/SET_EDIT_PROFILE';export var RESET_USER_POFILE='profile-reducer/RESET_USER_POFILE';export var FOLLOW_UNFOLLOW_SUCCESS='profile-reducer/FOLLOW_UNFOLLOW_SUCCESS';export var TOGGLE_IS_FETCHING='profile-reducer/TOGGLE_IS_FETCHING';export var SEND_MESSAGE_MODE='profile-reducer/SEND_MESSAGE_MODE';export var SET_POPPUP_AVATAR='profile-reducer/SET_POPPUP_AVATAR';export var TOGGLE_LIKE_SUCCESS='profile-reducer/TOGGLE_LIKE_SUCCESS';export var DELETE_POST_SUCCESS='profile-reducer/DELETE_POST_SUCCESS';export var SORT_BY_TIME='profile-reducer/SORT_BY_TIME';export var SORT_BY_LIKES='profile-reducer/SORT_BY_LIKES';export var IS_USER_EXIST='profile-reducer/IS_USER_EXIST';var options={year:'numeric',month:'long',day:'numeric',timezone:'UTC',hour:'numeric',minute:'numeric'};var initialState={posts:[{name:'ChelCode',userId:'1601',avatar:'https://social-network.samuraijs.com/activecontent/images/users/1601/user-small.jpg?v=13',text:'Whats up??!',id:2,likesCount:0,time:1574713363365,timeFormat:'November 11, 2019, 10:20 PM',liked:false},{name:'ChelCode',avatar:'https://social-network.samuraijs.com/activecontent/images/users/1601/user-small.jpg?v=13',text:'hello world!!',userId:'1601',id:1,likesCount:12,time:1574713324589,timeFormat:'November 9, 2019, 2:46 PM',liked:false}],currentTextPost:'',profile:null,status:'',isEditMode:false,isFollowed:false,isFetching:false,sendMessageMode:false,avatarPopup:false,isUserExist:true};export var profileReducer=function profileReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SEND_POST:return _objectSpread({},state,{posts:[{text:action.payload.post.postBody,time:action.payload.time,id:state.posts.length+1,likesCount:0,timeFormat:action.payload.timeFormat,liked:false,name:action.payload.name,avatar:action.payload.avatar,userId:action.payload.userId}].concat(_toConsumableArray(state.posts))});case SET_USER_PROFILE:return _objectSpread({},state,{profile:action.payload});case SET_USER_STATUS:return _objectSpread({},state,{status:action.payload});case SET_PHOTO_PROFILE:return _objectSpread({},state,{profile:_objectSpread({},state.profile,{photos:action.payload})});case SET_EDIT_PROFILE:return _objectSpread({},state,{isEditMode:action.payload});case RESET_USER_POFILE:return initialState;case FOLLOW_UNFOLLOW_SUCCESS:return _objectSpread({},state,{isFollowed:action.payload});case TOGGLE_IS_FETCHING:return _objectSpread({},state,{isFetching:action.payload});case SEND_MESSAGE_MODE:return _objectSpread({},state,{sendMessageMode:action.payload});case SET_POPPUP_AVATAR:return _objectSpread({},state,{avatarPopup:action.payload});case TOGGLE_LIKE_SUCCESS:return _objectSpread({},state,{posts:state.posts.map(function(p){return action.payload.idPost===p.id?_objectSpread({},p,{liked:action.payload.isLiked,likesCount:action.payload.isLiked?p.likesCount+1:p.likesCount-1}):p;})});case DELETE_POST_SUCCESS:return _objectSpread({},state,{posts:state.posts.filter(function(p){return p.id!==action.payload;}).map(function(p,index){return _objectSpread({},p,{id:index+1});})});case SORT_BY_TIME:return _objectSpread({},state,{posts:_toConsumableArray(state.posts.sort(function(a,b){return b.time-a.time;}))});case SORT_BY_LIKES:return _objectSpread({},state,{posts:_toConsumableArray(state.posts.sort(function(a,b){return b.likesCount-a.likesCount;}))});case IS_USER_EXIST:return _objectSpread({},state,{},action.payload);default:return state;}};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,payload:isFetching};};export var resetProfile=function resetProfile(){return{type:RESET_USER_POFILE};};export var sendPost=function sendPost(post,name,avatar,userId){return{type:SEND_POST,payload:{post:post,timeFormat:new Date(Date.now()).toLocaleString(\"en-US\",options),time:Date.now(),name:name,avatar:avatar,userId:userId}};};export var setEditProfile=function setEditProfile(mode){return{type:SET_EDIT_PROFILE,payload:mode};};export var setUserProfile=function setUserProfile(profile){return{type:SET_USER_PROFILE,payload:profile};};export var setUserStatus=function setUserStatus(status){return{type:SET_USER_STATUS,payload:status};};export var setFollowUnfollow=function setFollowUnfollow(isFollow){return{type:FOLLOW_UNFOLLOW_SUCCESS,payload:isFollow};};export var setMessageMode=function setMessageMode(isSendMode){return{type:SEND_MESSAGE_MODE,payload:{isSendMode:isSendMode}};};export var setPopupAvatar=function setPopupAvatar(isPopup){return{type:SET_POPPUP_AVATAR,payload:{isPopup:isPopup}};};export var likesToggle=function likesToggle(isLiked,idPost){return{type:TOGGLE_LIKE_SUCCESS,payload:{isLiked:isLiked,idPost:idPost}};};export var deletePost=function deletePost(idPost){return{type:DELETE_POST_SUCCESS,payload:idPost};};export var sortByTime=function sortByTime(){return{type:SORT_BY_TIME};};export var sortByLikes=function sortByLikes(){return{type:SORT_BY_LIKES};};export var setIsUserExist=function setIsUserExist(isUserExist){return{type:IS_USER_EXIST,payload:{isUserExist:isUserExist}};};export var savePhotoSucсess=function savePhotoSucсess(photos){return{type:SET_PHOTO_PROFILE,payload:photos};};export var sendPostThunk=function sendPostThunk(post){return function(dispatch,getState){var name=getState().auth.login;var avatar=getState().auth.avatar;var userId=getState().auth.id;dispatch(sendPost(post,name,avatar,userId));};};export var getProfileThunk=function getProfileThunk(userId){return function _callee(dispatch){var response;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(profileAPI.getProfile(userId).catch(function(){dispatch(setIsUserExist(false));}));case 2:response=_context.sent;if(response){dispatch(setUserProfile(response.data));}case 4:case\"end\":return _context.stop();}}});};};export var getStatusThunk=function getStatusThunk(userId){return function _callee2(dispatch){var data;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regeneratorRuntime.awrap(profileAPI.getUserStatus(userId));case 2:data=_context2.sent;dispatch(setUserStatus(data));case 4:case\"end\":return _context2.stop();}}});};};export var updateStatusThunk=function updateStatusThunk(status){return function _callee3(dispatch){var data;return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _regeneratorRuntime.awrap(profileAPI.updateUserStatus(status));case 2:data=_context3.sent;if(data.resultCode===0){dispatch(setUserStatus(status));}case 4:case\"end\":return _context3.stop();}}});};};export var savePhotoThunk=function savePhotoThunk(photo){return function _callee4(dispatch){var data;return _regeneratorRuntime.async(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _regeneratorRuntime.awrap(profileAPI.updatePhoto(photo));case 2:data=_context4.sent;if(data.resultCode===0){dispatch(savePhotoSucсess(data.data.photos));}case 4:case\"end\":return _context4.stop();}}});};};export var saveProfileData=function saveProfileData(profile){return function _callee5(dispatch,getState){var userId,response,number,test;return _regeneratorRuntime.async(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:userId=getState().auth.id;_context5.next=3;return _regeneratorRuntime.awrap(profileAPI.saveProfileData(profile));case 3:response=_context5.sent;if(response.resultCode===0){dispatch(profileR.getProfileThunk(userId));dispatch(setEditProfile(false));}else{number=response.messages[0].indexOf('>');test=response.messages[0].slice(number+1,-1).toLowerCase();dispatch(stopSubmit('edit-profile',{'contacts':_defineProperty({},test,test+' incorrect')}));}case 5:case\"end\":return _context5.stop();}}});};};export var getFollowedThunk=function getFollowedThunk(id){return function _callee6(dispatch){var data;return _regeneratorRuntime.async(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return _regeneratorRuntime.awrap(usersAPI.getFollow(id));case 2:data=_context6.sent;dispatch(setFollowUnfollow(data));case 4:case\"end\":return _context6.stop();}}});};};export var followUnfollow=function followUnfollow(isFollow,id){return function _callee7(dispatch){var data;return _regeneratorRuntime.async(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:dispatch(toggleIsFetching(true));if(!isFollow){_context7.next=7;break;}_context7.next=4;return _regeneratorRuntime.awrap(usersAPI.postFollow(id));case 4:_context7.t0=_context7.sent;_context7.next=10;break;case 7:_context7.next=9;return _regeneratorRuntime.awrap(usersAPI.deleteFollow(id));case 9:_context7.t0=_context7.sent;case 10:data=_context7.t0;if(data.resultCode===0){dispatch(setFollowUnfollow(isFollow));dispatch(toggleIsFetching(false));}case 12:case\"end\":return _context7.stop();}}});};};export default profileReducer;","map":{"version":3,"sources":["C:/Users/WOW/Documents/GitHub/react/react-test/src/redux/profile-reducer.js"],"names":["profileAPI","stopSubmit","usersAPI","profileR","SEND_POST","SET_USER_PROFILE","SET_USER_STATUS","SET_PHOTO_PROFILE","SET_EDIT_PROFILE","RESET_USER_POFILE","FOLLOW_UNFOLLOW_SUCCESS","TOGGLE_IS_FETCHING","SEND_MESSAGE_MODE","SET_POPPUP_AVATAR","TOGGLE_LIKE_SUCCESS","DELETE_POST_SUCCESS","SORT_BY_TIME","SORT_BY_LIKES","IS_USER_EXIST","options","year","month","day","timezone","hour","minute","initialState","posts","name","userId","avatar","text","id","likesCount","time","timeFormat","liked","currentTextPost","profile","status","isEditMode","isFollowed","isFetching","sendMessageMode","avatarPopup","isUserExist","profileReducer","state","action","type","payload","post","postBody","length","photos","map","p","idPost","isLiked","filter","index","sort","a","b","toggleIsFetching","resetProfile","sendPost","Date","now","toLocaleString","setEditProfile","mode","setUserProfile","setUserStatus","setFollowUnfollow","isFollow","setMessageMode","isSendMode","setPopupAvatar","isPopup","likesToggle","deletePost","sortByTime","sortByLikes","setIsUserExist","savePhotoSucсess","sendPostThunk","dispatch","getState","auth","login","getProfileThunk","getProfile","catch","response","data","getStatusThunk","getUserStatus","updateStatusThunk","updateUserStatus","resultCode","savePhotoThunk","photo","updatePhoto","saveProfileData","number","messages","indexOf","test","slice","toLowerCase","getFollowedThunk","getFollow","followUnfollow","postFollow","deleteFollow"],"mappings":"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","sourcesContent":["import { profileAPI } from '../API/api'\r\nimport { stopSubmit } from 'redux-form'\r\nimport { usersAPI } from '../API/api'\r\n\r\nimport * as profileR from './profile-reducer'\r\n\r\nexport const SEND_POST = 'profile-reducer/SEND_POST'\r\nexport const SET_USER_PROFILE = 'profile-reducer/SET_USER_PROFILE'\r\nexport const SET_USER_STATUS = 'profile-reducer/SET_USER_STATUS'\r\nexport const SET_PHOTO_PROFILE = 'profile-reducer/SET_PHOTO_PROFILE'\r\nexport const SET_EDIT_PROFILE = 'profile-reducer/SET_EDIT_PROFILE'\r\nexport const RESET_USER_POFILE = 'profile-reducer/RESET_USER_POFILE'\r\nexport const FOLLOW_UNFOLLOW_SUCCESS = 'profile-reducer/FOLLOW_UNFOLLOW_SUCCESS'\r\nexport const TOGGLE_IS_FETCHING = 'profile-reducer/TOGGLE_IS_FETCHING'\r\nexport const SEND_MESSAGE_MODE = 'profile-reducer/SEND_MESSAGE_MODE'\r\nexport const SET_POPPUP_AVATAR = 'profile-reducer/SET_POPPUP_AVATAR'\r\nexport const TOGGLE_LIKE_SUCCESS = 'profile-reducer/TOGGLE_LIKE_SUCCESS'\r\nexport const DELETE_POST_SUCCESS = 'profile-reducer/DELETE_POST_SUCCESS'\r\nexport const SORT_BY_TIME = 'profile-reducer/SORT_BY_TIME'\r\nexport const SORT_BY_LIKES = 'profile-reducer/SORT_BY_LIKES'\r\nexport const IS_USER_EXIST = 'profile-reducer/IS_USER_EXIST'\r\n\r\nconst options = {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n    timezone: 'UTC',\r\n    hour: 'numeric',\r\n    minute: 'numeric'\r\n}\r\n\r\n\r\nconst initialState = {\r\n    posts: [\r\n        {\r\n            name: 'ChelCode', userId: '1601', avatar: 'https://social-network.samuraijs.com/activecontent/images/users/1601/user-small.jpg?v=13',\r\n            text: 'Whats up??!', id: 2, likesCount: 0, time: 1574713363365, timeFormat: 'November 11, 2019, 10:20 PM', liked: false\r\n        },\r\n        {\r\n            name: 'ChelCode', avatar: 'https://social-network.samuraijs.com/activecontent/images/users/1601/user-small.jpg?v=13',\r\n            text: 'hello world!!', userId: '1601', id: 1, likesCount: 12, time: 1574713324589, timeFormat: 'November 9, 2019, 2:46 PM', liked: false\r\n        }],\r\n    currentTextPost: '',\r\n    profile: null,\r\n    status: '',\r\n    isEditMode: false,\r\n    isFollowed: false,\r\n    isFetching: false,\r\n    sendMessageMode: false,\r\n    avatarPopup: false,\r\n    isUserExist: true\r\n}\r\n\r\nexport const profileReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n\r\n        case SEND_POST:\r\n            return {\r\n                ...state,\r\n                posts: [{\r\n                    text: action.payload.post.postBody, time: action.payload.time, id: state.posts.length + 1, \r\n                    likesCount: 0, timeFormat: action.payload.timeFormat, liked: false, name: action.payload.name, \r\n                    avatar: action.payload.avatar, userId: action.payload.userId\r\n                }, ...state.posts],\r\n            }\r\n        case SET_USER_PROFILE:\r\n            return { ...state, profile: action.payload }\r\n        case SET_USER_STATUS:\r\n            return { ...state, status: action.payload }\r\n        case SET_PHOTO_PROFILE:\r\n            return { ...state, profile: { ...state.profile, photos: action.payload } }\r\n        case SET_EDIT_PROFILE:\r\n            return { ...state, isEditMode: action.payload }\r\n        case RESET_USER_POFILE:\r\n            return initialState\r\n        case FOLLOW_UNFOLLOW_SUCCESS:\r\n            return { ...state, isFollowed: action.payload }\r\n        case TOGGLE_IS_FETCHING:\r\n            return { ...state, isFetching: action.payload }\r\n        case SEND_MESSAGE_MODE:\r\n            return { ...state, sendMessageMode: action.payload }\r\n        case SET_POPPUP_AVATAR:\r\n            return { ...state, avatarPopup: action.payload }\r\n        case TOGGLE_LIKE_SUCCESS:\r\n            return { ...state, posts: state.posts.map(p => \r\n                action.payload.idPost === p.id \r\n                ? { ...p, liked: action.payload.isLiked, likesCount: action.payload.isLiked \r\n                    ? p.likesCount + 1 \r\n                    : p.likesCount - 1 } \r\n                : p) }\r\n        case DELETE_POST_SUCCESS:\r\n            return { ...state, posts: state.posts.filter(p => \r\n                p.id !== action.payload).map((p, index) => { return { ...p, id: index + 1 } }) }\r\n        case SORT_BY_TIME:\r\n            return { ...state, posts: [...state.posts.sort((a, b) => { return b.time - a.time })] }\r\n        case SORT_BY_LIKES:\r\n            return { ...state, posts: [...state.posts.sort((a, b) => { return b.likesCount - a.likesCount })] }\r\n        case IS_USER_EXIST:\r\n            return {...state, ...action.payload}    \r\n        default: return state\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n\r\nexport const toggleIsFetching = (isFetching) => ({ type: TOGGLE_IS_FETCHING, payload: isFetching })\r\nexport const resetProfile = () => ({ type: RESET_USER_POFILE })\r\nexport const sendPost = (post, name, avatar, userId) => ({ type: SEND_POST, payload: {post, timeFormat: new Date(Date.now()).toLocaleString(\"en-US\", options), time: Date.now(), name, avatar, userId} })\r\n\r\n\r\nexport const setEditProfile = (mode) => ({ type: SET_EDIT_PROFILE, payload: mode })\r\nexport const setUserProfile = (profile) => ({ type: SET_USER_PROFILE, payload: profile })\r\nexport const setUserStatus = (status) => ({ type: SET_USER_STATUS, payload: status })\r\nexport const setFollowUnfollow = (isFollow) => ({ type: FOLLOW_UNFOLLOW_SUCCESS, payload: isFollow })\r\nexport const setMessageMode = (isSendMode) => ({ type: SEND_MESSAGE_MODE, payload: {isSendMode} })\r\nexport const setPopupAvatar = (isPopup) => ({ type: SET_POPPUP_AVATAR, payload: {isPopup} })\r\nexport const likesToggle = (isLiked, idPost) => ({ type: TOGGLE_LIKE_SUCCESS, payload: {isLiked, idPost} })\r\nexport const deletePost = (idPost) => ({ type: DELETE_POST_SUCCESS, payload: idPost })\r\nexport const sortByTime = () => ({ type: SORT_BY_TIME })\r\nexport const sortByLikes = () => ({ type: SORT_BY_LIKES })\r\nexport const setIsUserExist = (isUserExist) => ({ type: IS_USER_EXIST, payload: {isUserExist} })\r\nexport const savePhotoSucсess = (photos) => ({ type: SET_PHOTO_PROFILE, payload: photos })\r\nexport const sendPostThunk = (post) => (dispatch, getState) => {\r\n\r\n    const name = getState().auth.login\r\n    const avatar = getState().auth.avatar\r\n    const userId = getState().auth.id\r\n    dispatch(sendPost(post, name, avatar, userId))\r\n}\r\nexport const getProfileThunk = (userId) => async (dispatch) => {\r\n    \r\n    \r\n    const response = await (profileAPI.getProfile(userId)).catch(()=>{\r\n        dispatch(setIsUserExist(false))\r\n    })\r\n    \r\n      if(response){\r\n          \r\n        dispatch(setUserProfile(response.data))  \r\n    } \r\n\r\n      \r\n    \r\n     \r\n}\r\n\r\n\r\n\r\nexport const getStatusThunk = (userId) => async (dispatch) => {\r\n    const data = await (profileAPI.getUserStatus(userId))\r\n\r\n    dispatch(setUserStatus(data))\r\n\r\n}\r\nexport const updateStatusThunk = (status) => async (dispatch) => {\r\n    const data = await (profileAPI.updateUserStatus(status))\r\n\r\n    if (data.resultCode === 0) {\r\n        dispatch(setUserStatus(status))\r\n    }\r\n\r\n}\r\nexport const savePhotoThunk = (photo) => async (dispatch) => {\r\n    const data = await (profileAPI.updatePhoto(photo))\r\n\r\n    if (data.resultCode === 0) {\r\n        dispatch(savePhotoSucсess(data.data.photos))\r\n    }\r\n\r\n}\r\nexport const saveProfileData = (profile) => async (dispatch, getState) => {\r\n    const userId = getState().auth.id\r\n    const response = await (profileAPI.saveProfileData(profile))\r\n\r\n\r\n    if (response.resultCode === 0) {\r\n        dispatch(profileR.getProfileThunk(userId))\r\n        dispatch(setEditProfile(false))\r\n    } else {\r\n        let number = response.messages[0].indexOf('>')\r\n        let test = response.messages[0].slice(number + 1, -1).toLowerCase()\r\n        dispatch(stopSubmit('edit-profile', { 'contacts': { [test]: test + ' incorrect' } }))\r\n    }\r\n}\r\nexport const getFollowedThunk = (id) => async (dispatch) => {\r\n    const data = await (usersAPI.getFollow(id))\r\n    dispatch(setFollowUnfollow(data))\r\n\r\n}\r\nexport const followUnfollow = (isFollow, id) => async (dispatch) => {\r\n    dispatch(toggleIsFetching(true))\r\n    const data =\r\n        isFollow\r\n            ? await usersAPI.postFollow(id)\r\n            : await usersAPI.deleteFollow(id)\r\n    if (data.resultCode === 0) {\r\n        dispatch(setFollowUnfollow(isFollow))\r\n        dispatch(toggleIsFetching(false))\r\n    }\r\n\r\n\r\n}\r\nexport default profileReducer"]},"metadata":{},"sourceType":"module"}