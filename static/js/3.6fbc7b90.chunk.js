(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{315:function(e,a,s){e.exports={messages:"Messages_messages__2Czpm",dialog:"Messages_dialog__tfj-k",dialogItems:"Messages_dialogItems__2OoFm",dialogHead:"Messages_dialogHead__BDJuz",dialogBody:"Messages_dialogBody__Pv6vX",messageOut:"Messages_messageOut__1ecbx",messagesFill:"Messages_messagesFill__2JJHa",formContainer:"Messages_formContainer__PFn6z",avatar:"Messages_avatar__FiFmh",avatarContainer:"Messages_avatarContainer__1PCd-",name:"Messages_name__1VKCA",buttonForm:"Messages_buttonForm__3NwVr",emptyMessages:"Messages_emptyMessages__12fxk",selectDialog:"Messages_selectDialog__1geCX",iconMessage:"Messages_iconMessage__3b62w",dialogSearch:"Messages_dialogSearch__1DKPy",searchInput:"Messages_searchInput__2JgjW",buttomEmoji:"Messages_buttomEmoji__gcgVt",emojyPickerP:"Messages_emojyPickerP__2lktl"}},316:function(e,a,s){e.exports={items:"DialogWithUser_items__2hRxI",name:"DialogWithUser_name__2SpA4",message:"DialogWithUser_message__2BINV",selectedDialog:"DialogWithUser_selectedDialog__adA2o",avatar:"DialogWithUser_avatar__3n_ux",timeLastMessage:"DialogWithUser_timeLastMessage__1lmR_",yourMessage:"DialogWithUser_yourMessage__27Rr9"}},317:function(e,a,s){e.exports={message:"MessageItem_message__3fTmO",messageRight:"MessageItem_messageRight__1aGY_",messageContainer:"MessageItem_messageContainer__DmkNm",time:"MessageItem_time__pQF6M",timeRight:"MessageItem_timeRight__1aq_t",timeLeft:"MessageItem_timeLeft__22qsT"}},322:function(e,a,s){"use strict";s.r(a);var t=s(0),n=s.n(t),r=s(81),c=s(57),m=s(36),i=s(17),l=s(315),o=s.n(l),g=s(316),u=s.n(g),d=s(5),_=function(e){Object(t.useEffect)(function(){c(Object(d.b)(new Date(e.date)))},[e.date]);var a=Object(t.useState)(null),s=Object(m.a)(a,2),r=s[0],c=s[1];return n.a.createElement("div",{onClick:function(){e.setDialogID(e.id),e.isSearchMode&&e.outSearch()},ref:e.dialogRef,className:u.a.items+" "+(e.currentDialogId===e.id?u.a.selectedDialog:"")},n.a.createElement("div",null,n.a.createElement("img",{className:u.a.avatar,src:e.avatar,alt:"avatar"})),n.a.createElement("div",null,n.a.createElement("div",{className:u.a.name},e.name),n.a.createElement("span",{className:u.a.message},e.isYoursMessage?n.a.createElement("span",{className:u.a.yourMessage},"You: "):"",e.lastMessage.length>50?e.lastMessage.slice(0,50)+"...":e.lastMessage)),n.a.createElement("span",{className:u.a.timeLastMessage},r))},f=s(317),h=s.n(f),M=function(e){return e.right?n.a.createElement("div",{className:h.a.messageContainer},n.a.createElement("div",{className:h.a.time+" "+h.a.timeRight},e.time),n.a.createElement("div",{className:h.a.message+" "+h.a.messageRight},e.message)):n.a.createElement("div",{className:h.a.messageContainer},n.a.createElement("div",{className:h.a.message},e.message),n.a.createElement("div",{className:h.a.time+" "+h.a.timeLeft},e.time))},v=s(4),b=s(318),E=n.a.forwardRef(function(e,a){var s=e.children,r=Object(i.a)(e,["children"]),c=Object(t.useState)(!1),l=Object(m.a)(c,2),o=l[0],g=l[1],u=Object(t.useState)(!1),d=Object(m.a)(u,2),_=d[0],f=d[1],h=o||_,M=Object(t.useCallback)(function(){g(!0)},[]),E=Object(t.useCallback)(function(){g(!1)},[]),I=Object(t.useCallback)(function(){f(!0)},[]),j=Object(t.useCallback)(function(){f(!1)},[]),D=Object(t.useMemo)(function(){return{renderer:function(e){var a=e.elementRef,s=e.style,t=Object(i.a)(e,["elementRef","style"]);return n.a.createElement("span",Object.assign({},t,{ref:a,style:Object(v.a)({},s,{opacity:h?1:0,transition:"opacity 0.4s ease-in-out"}),onMouseEnter:I,onMouseLeave:j}))}}},[h,I,j]);return n.a.createElement(b.a,Object.assign({},r,{wrapperProps:{renderer:function(e){var a=e.elementRef,s=e.style,t=Object(i.a)(e,["elementRef","style"]);return n.a.createElement("div",Object.assign({},t,{ref:a,style:Object(v.a)({},s,{right:0})}))}},trackXProps:D,trackYProps:D,onScrollStart:M,onScrollStop:E,scrollDetectionThreshold:500,ref:a}),s)}),I=s(10),j=s(25),D=s(141),p=s(14),O=s(21),N=s(79),y=s(12),S=Object(D.a)({form:"addMessageForm",onSubmitSuccess:function(e,a){a(Object(j.b)("addMessageForm"))}})(function(e){return n.a.createElement("form",{onKeyDown:function(a){13==a.keyCode&&0==a.shiftKey&&a.target.name=="message".concat(e.userId)&&(a.preventDefault(),e.handleSubmit())},onSubmit:e.handleSubmit},Object(p.c)("write message to ".concat(e.name),"message".concat(e.userId),[O.b,O.c],"textarea",null,null,{autoFocus:!0}),e.dirty&&n.a.createElement("button",{className:o.a.buttonForm,type:"submit"}),n.a.createElement(N.b,{formName:"addMessageForm",fieldName:"message".concat(e.userId),Form:e.addMessageForm,styles:o.a,dispatch:e.dispatch}))}),k=Object(y.b)(function(e){return{addMessageForm:e.form.addMessageForm}})(S),F=function(e){var a=e.messages.map(function(e,a){return n.a.createElement(M,{time:e.timeFormat,key:a,right:e.right,message:e.message,id:e.id})}),s=Object(t.useRef)();return Object(t.useEffect)(function(){!e.isSearchMode&&document.querySelector("textarea[name=message".concat(e.userId,"]")).focus()}),Object(t.useEffect)(function(){s.current.scrollToBottom()},[a]),n.a.createElement("div",{className:o.a.dialog},n.a.createElement("div",{className:o.a.dialogHead},n.a.createElement("div",{className:o.a.avatarContainer},n.a.createElement(I.b,{to:"/profile/".concat(e.userId)},n.a.createElement("img",{className:o.a.avatar,src:e.avatar,alt:"avatar"}))),n.a.createElement("span",{className:o.a.name},n.a.createElement(I.b,{to:"/profile/".concat(e.userId)},e.name))),n.a.createElement(E,{children:n.a.createElement("div",{className:o.a.messagesFill},a),autoHide:!0,ref:s,removeTrackYWhenNotUsed:!0,style:{width:"100%",height:"75%"}}),n.a.createElement("div",{className:o.a.formContainer},n.a.createElement(k,{userId:e.userId,name:e.name,onSubmit:function(a){e.sendMessage(a["message".concat(e.userId)],e.userId)}})))},C=function(e){var a=e.dialogItemsData,s=e.currentDialogId,r=e.search,c=e.dialogsFromSearch,l=Object(i.a)(e,["dialogItemsData","currentDialogId","search","dialogsFromSearch"]),g=Object(t.useState)(null),u=Object(m.a)(g,2),d=u[0],f=u[1],h=Object(t.useState)(!1),M=Object(m.a)(h,2),v=M[0],b=M[1];Object(t.useEffect)(function(){return v?document.addEventListener("click",p):document.removeEventListener("click",p),function(){document.removeEventListener("click",p)}},[v]);var I=Object(t.useRef)(),j=Object(t.useRef)(),D=function(){b(!1),f("")},p=function(e){e.target!==I.current&&e.target!==j.current&&D()},O=a.map(function(e,a){return n.a.createElement(_,{currentDialogId:s,avatar:e.avatar,date:e.messages[e.messages.length-1].date,isYoursMessage:e.messages[e.messages.length-1].right,lastMessage:e.messages[e.messages.length-1].message,setDialogID:l.setDialogID,key:a+1,name:e.name,id:e.userId})}),N=v&&c.map(function(e,a){return n.a.createElement(_,{dialogRef:j,isSearchMode:v,currentDialogId:s,avatar:e.avatar,outSearch:D,lastMessage:e.messages[e.messages.length-1].message,date:e.messages[e.messages.length-1].date,isYoursMessage:e.messages[e.messages.length-1].right,setDialogID:l.setDialogID,key:a+1,name:e.name,id:e.userId})}),y=a[a.findIndex(function(e){return e.userId===s})];return n.a.createElement("div",{className:o.a.messages},0===s?n.a.createElement("div",{className:o.a.emptyMessages},n.a.createElement("div",{className:o.a.iconMessage}),n.a.createElement("div",{className:o.a.selectDialog},"Please select a dialog")):n.a.createElement(F,{valueMessage:l.valueMessage,isSearchMode:v,userId:y.userId,sendMessage:l.sendMessage,name:y.name,avatar:y.avatar,messages:y.messages}),n.a.createElement("div",{className:o.a.dialogItems},n.a.createElement("div",{className:o.a.dialogSearch},n.a.createElement("input",{ref:I,placeholder:"Search",className:o.a.searchInput,value:d,onChange:function(e){return function(e){var a=e.currentTarget.value;f(a),a&&""!==a.trim()&&(r(a),b(!0))}(e)},type:"text",name:"",id:""})),n.a.createElement("div",{className:o.a.dialogsList},n.a.createElement(E,{children:v?N:O,autoHide:!0,removeTrackYWhenNotUsed:!0,style:{width:"100%",height:"85vh"}}))))},R=s(9),w=Object(R.d)(Object(y.b)(function(e){return{dialogItemsData:e.Messages.dialogItemsData,currentDialogId:e.Messages.currentDialogId,dialogsFromSearch:e.Messages.dialogsFromSearch}},{sendMessage:c.d,setDialogID:c.e,search:c.c}),r.a)(C);a.default=w}}]);
//# sourceMappingURL=3.6fbc7b90.chunk.js.map